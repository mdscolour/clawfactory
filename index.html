<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClawFactory - OpenClaw Copy Registry</title>
  <link rel="stylesheet" href="styles.css">
  <script src="config.js" defer></script>
  <script src="api.js" defer></script>
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="logo">
        <span class="logo-icon">ğŸ¦</span>
        <span class="logo-text">ClawFactory</span>
      </div>
      <nav class="nav">
        <a href="#" class="nav-link active" data-page="browse">Copies</a>
        <a href="#" class="nav-link" data-page="marketplace">ğŸ›’ Marketplace</a>
        <a href="#" class="nav-link" data-page="compare">Compare</a>
        <a href="#" class="nav-link" data-page="authors">Authors</a>
        <a href="#" class="nav-link" data-page="sync">ğŸ”„ Sync</a>
        <a href="#" class="nav-link" data-page="my-copies">My Copies</a>
        <a href="#" class="nav-link" data-page="upload">Upload</a>
        <a href="#" class="nav-link" data-page="cli">CLI</a>
        <a href="#" class="nav-link" data-page="ai" style="opacity: 0.6;">ğŸ¤– AI</a>
      </nav>
      <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <span id="themeIcon">ğŸŒ™</span>
      </button>
    </div>
  </header>

  <main class="main">
    <div class="container">
      <!-- Browse Page -->
      <div id="browsePage">
        <!-- Hero Section -->
        <section class="hero">
          <h1>OpenClaw Copy Registry</h1>
          <p>Discover and share pre-configured OpenClaw copies with skills, workspaces, and personalized settings.</p>
          <div class="search-bar">
            <input type="text" id="searchInput" placeholder="Search copies...">
          </div>
        </section>

        <!-- Featured Copies -->
        <section class="featured-section" id="featuredSection">
          <h2>â­ Featured Copies</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px;">Hand-picked top rated copies for you</p>
          <div class="featured-grid" id="featuredList">
            <!-- Featured copies will be rendered here -->
          </div>
        </section>

        <!-- Filters -->
        <section class="filters">
          <div class="filter-group">
            <label class="toggle">
              <input type="checkbox" id="memoryToggle">
              <span class="toggle-label">å¸¦ Memory</span>
            </label>
            <span class="filter-note">æ˜¾ç¤ºåŒ…å«é•¿æœŸè®°å¿†çš„ copies</span>
          </div>
        </section>

        <!-- Copy List -->
        <section class="copy-list" id="copyList">
          <!-- Copies will be rendered here -->
        </section>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
          <p>No copies found matching your criteria.</p>
        </div>
      </div>

      <!-- Marketplace Page -->
      <div id="marketplacePage" style="display: none;">
        <section class="hero">
          <h1>ğŸ›’ Copy Marketplace</h1>
          <p>Discover and share community-published copies</p>
        </section>

        <!-- Marketplace Filters -->
        <section class="filters">
          <div class="filter-group">
            <label class="toggle">
              <input type="checkbox" id="marketplaceToggle">
              <span class="toggle-label">Marketplace Only</span>
            </label>
            <select id="marketplaceSort" style="padding: 8px 12px; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px; color: var(--text);" onchange="renderMarketplace()">
              <option value="rating">Top Rated</option>
              <option value="popular">Most Popular</option>
              <option value="recent">Recently Published</option>
            </select>
          </div>
        </section>

        <!-- Marketplace List -->
        <section class="copy-list" id="marketplaceList">
          <!-- Marketplace copies will be rendered here -->
        </section>

        <div class="empty-state" id="marketplaceEmpty" style="display: none;">
          <p>No marketplace copies available. Publish your copies to share with the community!</p>
        </div>
      </div>

      <!-- Compare Page -->
      <div id="comparePage" style="display: none;">
        <section class="hero">
          <h1>Compare Copies</h1>
          <p>Select up to 3 copies to compare side by side</p>
        </section>

        <!-- Copy Selection -->
        <section class="compare-selection">
          <h2 style="margin-bottom: 16px;">Select Copies</h2>
          <div class="compare-grid" id="compareCopyList">
            <!-- Copies for comparison will be rendered here -->
          </div>
        </section>

        <!-- Comparison Results -->
        <section class="compare-results" id="compareResults" style="display: none;">
          <h2 style="margin-bottom: 24px;">Comparison</h2>
          <div class="comparison-table" id="comparisonTable">
            <!-- Comparison results will be rendered here -->
          </div>
        </section>
      </div>

      <!-- Sync Page -->
      <div id="syncPage" style="display: none;">
        <section class="hero">
          <h1>ğŸ”„ Cloud Sync</h1>
          <p>Sync your copies with the cloud backend</p>
        </section>

        <!-- Auth Section -->
        <section class="my-copies-section">
          <h2>ğŸ‘¤ Account</h2>
          <div id="authSection">
            <div id="authForm" style="display: none;">
              <div class="form-group">
                <label for="syncUsername">Username</label>
                <input type="text" id="syncUsername" placeholder="Enter your username">
              </div>
              <div class="form-actions">
                <button class="btn btn-primary" onclick="syncRegister()">Register</button>
                <button class="btn btn-secondary" onclick="syncLogin()">Login</button>
              </div>
            </div>
            <div id="authStatus" style="display: none;">
              <p>Logged in as: <strong id="currentUsername"></strong></p>
              <button class="btn btn-secondary" onclick="syncLogout()">Logout</button>
            </div>
          </div>
        </section>

        <!-- Sync Actions -->
        <section class="my-copies-section">
          <h2>ğŸ”„ Sync Actions</h2>
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="syncFromCloud()">â¬‡ï¸ Download from Cloud</button>
            <button class="btn btn-secondary" onclick="syncToCloud()">â¬†ï¸ Upload to Cloud</button>
          </div>
          <p id="syncStatus" style="margin-top: 16px; color: var(--text-secondary);"></p>
        </section>

        <!-- Backend Status -->
        <section class="my-copies-section">
          <h2>ğŸŒ Backend Status</h2>
          <div id="backendStatus">
            <p>Checking connection...</p>
          </div>
        </section>
      </div>

      <!-- Authors Page -->
      <div id="authorsPage" style="display: none;">
        <section class="hero">
          <h1>Authors</h1>
          <p>Discover copies by their creators.</p>
        </section>

        <section class="authors-grid" id="authorsList">
          <!-- Authors will be rendered here -->
        </section>
      </div>

      <!-- Author Profile Page -->
      <div id="authorProfilePage" style="display: none;">
        <section class="hero">
          <button class="btn btn-secondary" onclick="switchPage('authors')" style="margin-bottom: 16px;">â† Back to Authors</button>
          <h1 id="authorName">Author Name</h1>
          <p id="authorBio">Author bio</p>
        </section>

        <section class="author-copies" id="authorCopiesList">
          <!-- Author's copies will be rendered here -->
        </section>
      </div>

      <!-- My Copies Page -->
      <div id="myCopiesPage" style="display: none;">
        <section class="hero">
          <h1>My Copies</h1>
          <p>Manage your uploaded copies and installations.</p>
        </section>

        <!-- Installed Copies -->
        <section class="my-copies-section">
          <h2>ğŸ–¥ï¸ Installed Copies</h2>
          <div class="installed-list" id="installedList">
            <p class="empty-message">No copies installed yet.</p>
          </div>
        </section>

        <!-- Uploaded Copies -->
        <section class="my-copies-section">
          <h2>ğŸ“¤ Uploaded Copies</h2>
          <div class="uploaded-list" id="uploadedList">
            <p class="empty-message">No copies uploaded yet.</p>
          </div>
        </section>

        <!-- Actions -->
        <section class="my-copies-section">
          <h2>âš™ï¸ Actions</h2>
          <div class="action-buttons">
            <button class="btn btn-primary" onclick="exportAllCopies()">ğŸ“¤ Export All Data</button>
            <button class="btn btn-secondary" onclick="importCopies()">ğŸ“¥ Import Data</button>
            <button class="btn btn-secondary" onclick="bulkExport()">ğŸ“¦ Export Copies</button>
            <button class="btn btn-secondary" onclick="bulkImport()">ğŸ“¥ Import Copies</button>
            <button class="btn btn-secondary" onclick="showAllBackups()">ğŸ’¾ Manage Backups</button>
            <button class="btn btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ Clear All Data</button>
          </div>
        </section>
      </div>

      <!-- Upload Page -->
      <div id="uploadPage" style="display: none;">
        <section class="hero">
          <h1>Upload Your Copy</h1>
          <p>Share your OpenClaw configuration with the community.</p>
        </section>

        <form id="uploadForm" class="upload-form">
          <div class="form-group">
            <label for="copyName">Copy Name *</label>
            <input type="text" id="copyName" required placeholder="e.g., Polymarket Trader">
          </div>

          <div class="form-group">
            <label for="copyDescription">Description *</label>
            <textarea id="copyDescription" required placeholder="Brief description of your copy..."></textarea>
          </div>

          <div class="form-group">
            <label for="copyAuthor">Author *</label>
            <input type="text" id="copyAuthor" required placeholder="Your name or username">
          </div>

          <div class="form-group">
            <label for="copyVersion">Version</label>
            <input type="text" id="copyVersion" placeholder="1.0.0" value="1.0.0">
          </div>

          <div class="form-group">
            <label>Memory</label>
            <div class="form-row">
              <label class="radio-label">
                <input type="radio" name="hasMemory" value="true">
                <span>å¸¦ Memory</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="hasMemory" value="false" checked>
                <span>ä¸å¸¦ Memory</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="copySkills">Skills (comma-separated) *</label>
            <input type="text" id="copySkills" required placeholder="e.g., trading, monitoring, polymarket">
          </div>

          <div class="form-group">
            <label for="copyTags">Tags (comma-separated)</label>
            <input type="text" id="copyTags" placeholder="e.g., trading, automation, finance (optional)">
          </div>

          <div class="form-group">
            <label for="copyCategory">Category</label>
            <select id="copyCategory" onchange="toggleCustomCategory()">
              <option value="">-- é€‰æ‹©ç±»åˆ« --</option>
              <option value="financial">ğŸ’° Financial</option>
              <option value="frontend-dev">ğŸ¨ Frontend Dev</option>
              <option value="backend-dev">âš™ï¸ Backend Dev</option>
              <option value="fullstack-dev">ğŸ”„ Fullstack Dev</option>
              <option value="pm">ğŸ“‹ PM</option>
              <option value="designer">ğŸ¨ Designer</option>
              <option value="marketing">ğŸ“¢ Marketing</option>
              <option value="secretary">ğŸ‘©â€ğŸ’¼ Secretary</option>
              <option value="video-maker">ğŸ¬ Video Maker</option>
              <option value="productivity">ğŸš€ Productivity</option>
              <option value="content">âœï¸ Content</option>
              <option value="research">ğŸ”¬ Research</option>
              <option value="others">ğŸ“¦ Others</option>
              <option value="custom">âœ¨ è‡ªå®šä¹‰...</option>
            </select>
            <input type="text" id="customCategory" placeholder="è¾“å…¥è‡ªå®šä¹‰ç±»åˆ«" style="display: none; margin-top: 8px;">
          </div>

          <div class="form-group">
            <label>Privacy</label>
            <div class="form-row">
              <label class="radio-label">
                <input type="radio" name="isPrivate" value="false" checked>
                <span>ğŸ”“ Public</span>
              </label>
              <label class="radio-label">
                <input type="radio" name="isPrivate" value="true">
                <span>ğŸ”’ Private</span>
              </label>
            </div>
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 8px;">
              Private copies are only visible to you. Use for personal configurations.
            </p>
          </div>

          <div class="form-group">
            <label for="copyFeatures">Features (one per line) *</label>
            <textarea id="copyFeatures" required placeholder="Feature 1&#10;Feature 2&#10;Feature 3"></textarea>
          </div>

          <div class="form-group">
            <label>Complete Snapshot Files</label>
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 8px;">
              Upload a JSON file with all files (SKILL.md, SOUL.md, config.js, etc.)
            </p>
            <input type="file" id="copyFilesJson" accept=".json" onchange="handleFilesUpload()">
            <textarea id="copyFilesContent" placeholder='{"SKILL.md": "...", "SOUL.md": "...", "config.js": "..."}' style="width: 100%; min-height: 120px; margin-top: 8px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-family: monospace; font-size: 0.85rem;"></textarea>
          </div>

          <div class="form-group">
            <label>Memory Content (optional)</label>
            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 8px;">
              Paste memory file content if this copy has memory. Leave empty if no memory.
            </p>
            <textarea id="copyMemory" placeholder="Paste memory content here (e.g., memory/{copyId}.md)..." style="width: 100%; min-height: 80px; padding: 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text);"></textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Submit Copy</button>
          </div>
        </form>
      </div>

      <!-- CLI Page -->
      <div id="cliPage" style="display: none;">
        <section class="hero">
          <h1>CLI Installation</h1>
          <p>Install any copy with a single command.</p>
        </section>

        <div class="cli-section">
          <h2>Install a Copy</h2>
          <div class="install-command">
            <code>clawfactory install &lt;copy-id&gt;</code>
          </div>
        </div>

        <div class="cli-section">
          <h2>Available Commands</h2>
          <table class="cli-table">
            <tr>
              <td><code>clawfactory list</code></td>
              <td>List all available copies</td>
            </tr>
            <tr>
              <td><code>clawfactory search &lt;query&gt;</code></td>
              <td>Search for copies</td>
            </tr>
            <tr>
              <td><code>clawfactory install &lt;copy-id&gt;</code></td>
              <td>Install a specific copy</td>
            </tr>
            <tr>
              <td><code>clawfactory upload</code></td>
              <td>Upload your own copy (opens editor)</td>
            </tr>
          </table>
        </div>

        <div class="cli-section">
          <h2>Quick Install (Recommended)</h2>
          <p>Install any copy with a single command:</p>
          <div class="install-command">
            <code>bash <(curl -sL https://clawhub.com/install/&lt;copy-id&gt;.sh)</code>
          </div>
          <p style="font-size: 0.9rem; color: var(--text-secondary); margin-top: 12px;">
            ğŸ’¡ Tip: Click any copy below to get its exact install command.
          </p>
        </div>

        <div class="cli-section">
          <h2>Alternative: Download & Run Script</h2>
          <p>Download the install script and run it manually:</p>
          <div class="install-command">
            <code>chmod +x install-&lt;copy-id&gt;.sh && ./install-&lt;copy-id&gt;.sh</code>
          </div>
        </div>

        <div class="cli-section">
          <h2>Install ClawFactory CLI</h2>
          <div class="install-command">
            <code>npm install -g clawfactory</code>
          </div>
        </div>

        <div class="cli-section">
          <h2>Quick Install Commands</h2>
          <p>Copy and run any of these commands:</p>
          <div id="cliCopyList">
            <!-- Dynamic copy commands will be rendered here -->
          </div>
        </div>
      </div>

      <!-- AI API Page -->
      <div id="aiPage" style="display: none;">
        <section class="hero">
          <h1>ğŸ¤– AI API</h1>
          <p>ClawFactory API for AI agents</p>
        </section>

        <section class="ai-section">
          <h2>ğŸ”— API Endpoints</h2>
          <div class="api-endpoint">
            <code>GET /api/copies</code>
            <p>List all public copies (supports ?category=...)</p>
          </div>
          <div class="api-endpoint">
            <code>GET /api/copies/:id</code>
            <p>Get single copy (returns files + memory)</p>
          </div>
          <div class="api-endpoint">
            <code>GET /api/search?q=...</code>
            <p>Search copies by name, description, skills, tags</p>
          </div>
          <div class="api-endpoint">
            <code>GET /api/categories</code>
            <p>List all categories</p>
          </div>
          <div class="api-endpoint">
            <code>GET /.well-known/ai-manifest.json</code>
            <p>AI discovery manifest (for OpenClaw AI)</p>
          </div>
        </section>

        <section class="ai-section">
          <h2>ğŸ“¦ Install Copy</h2>
          <p>For AI agents, use the install command:</p>
          <div class="install-command">
            <code>clawfactory install &lt;copy-id&gt;</code>
          </div>
          <p style="margin-top: 12px; color: var(--text-secondary);">
            This downloads the complete snapshot and restores all files.
          </p>
        </section>

        <section class="ai-section">
          <h2>ğŸ”§ OpenClaw AI Integration</h2>
          <p>OpenClaw AI can discover and install copies automatically:</p>
          <pre style="background: var(--bg-secondary); padding: 16px; border-radius: 8px; overflow-x: auto;">
// AI can call clawfactory CLI directly
exec("clawfactory install polymarket-trader");

// Or use the API to find copies first
const copies = await fetch("https://clawfactory.com/api/search?q=trading");
          </pre>
        </section>

        <section class="ai-section">
          <h2>ğŸ“ Categories</h2>
          <p>Filter by category:</p>
          <div class="category-chips" id="aiCategoryChips">
            <span class="chip" data-category="">All</span>
            <!-- Categories rendered dynamically -->
          </div>
        </section>

        <section class="ai-section">
          <h2>ğŸ“‹ Example: Find Financial Copy</h2>
          <pre style="background: var(--bg-secondary); padding: 16px; border-radius: 8px; overflow-x: auto;">
// Search for financial/trading related copies
GET /api/search?q=financial&category=financial

// Response:
{
  "copies": [
    {
      "id": "polymarket-trader",
      "name": "Polymarket Trader",
      "category": "financial",
      "skills": ["trading", "monitoring"],
      "files": {
        "SKILL.md": "...",
        "SOUL.md": "..."
      },
      "memory": "..."
    }
  ]
}
          </pre>
        </section>
      </div>
    </div>
  </main>

  <!-- Copy Detail Modal -->
  <div class="modal" id="copyModal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <button class="modal-close" id="modalClose">&times;</button>
      <div class="modal-body" id="modalBody">
        <!-- Copy details will be rendered here -->
      </div>
    </div>
  </footer>

  <!-- Hidden file input for import -->
  <input type="file" id="importFileInput" accept=".json" style="display: none;" onchange="handleImportFile(event)">

  <footer class="footer">
    <div class="container">
      <p>ClawFactory - Share your OpenClaw configuration with the world</p>
    </div>
  </footer>

  <script src="app.js"></script>
</body>
</html>
